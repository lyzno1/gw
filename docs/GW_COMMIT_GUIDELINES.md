# 使用 `gw` 命令遵循 Git 提交规范

本文档旨在指导开发者如何在使用 `gw` (Git Workflow) 工具时，遵循项目所采纳的 Git 提交信息规范，以确保代码提交历史的清晰、一致和可追溯性。

## 项目提交规范核心格式

我们项目遵循以下 Git 提交信息格式：

```
<type>(<scope>): <中文主题>

<中文正文> (可选)

<页脚> (可选)
```

### 主要 `<type>` 类型包括：

*   **feat**: 新功能或增强
*   **fix**: Bug 修复
*   **docs**: 仅文档更改
*   **style**: 代码风格调整（不影响功能）
*   **refactor**: 代码重构（非新增功能也非修复 bug）
*   **perf**: 性能优化
*   **test**: 添加或修改测试
*   **chore**: 构建过程、辅助工具、库等更改
*   **revert**: 撤销之前的提交

### `<scope>` (可选)

指明此次提交影响的代码库部分（如 `api`, `ui`, `db`, `core`, `auth` 等）。

### `<中文主题>`

对变更的简短、清晰的中文描述，动词开头，现在时态，不超过50字符，末尾无句号。

### `<中文正文>` 和 `<页脚>` (可选)

如果需要更详细的解释或关联 Issue，可以在空一行后添加正文和页脚。

*(更多关于规范的详细内容，请参考项目提供的完整 Git Commit Message Guidelines 文档。)*

## 如何使用 `gw` 命令遵循规范

`gw` 工具提供了便捷的 `save` 和 `commit` 命令来帮助您提交代码。以下是如何在使用这些命令时遵循上述规范：

### 1. 使用 `gw save` (不带 `-m` 或 `-e` 参数，进入编辑器模式)

这是推荐的方式，尤其当您需要编写多行提交信息（包含正文或页脚）时。

*   当您运行 `gw save` 时，脚本会暂存所有变更（或您指定的文件），然后打开一个编辑器（优先使用您通过 `gw ide` 配置的编辑器，然后依次尝试 `code --wait`, `$VISUAL`, `$EDITOR`）让您编辑提交信息。
*   打开的 `COMMIT_EDITMSG` 文件会包含一个模板，其**第一行是空白行**。
*   **操作步骤**：
    1.  在文件的**第一行空白处**，按照 `<type>(<scope>): <中文主题>` 的格式输入您的提交标题。
        例如：`feat(api): 添加用户登录功能`
    2.  如果需要添加**正文**，请在标题下方**空一行**，然后输入详细的中文描述。可以有多段，每段之间也用空行隔开。
    3.  如果需要添加**页脚**（例如关联 Issue），请在正文下方（或标题下方，如果没有正文）**空一行**，然后输入页脚信息。
        例如：`Closes #123` 或 `BREAKING CHANGE: 用户认证方式已更新`
    4.  模板中以 `#` 开头的行都是注释，它们将被忽略，不会包含在最终的提交信息中。
    5.  编辑完成后，保存并关闭编辑器。如果编辑器是脚本自动打开的（如 VS Code 通过 `code --wait`），关闭编辑器后提交会自动继续。如果您是手动打开的文件，请回到终端按 Enter 键。

**示例 (`COMMIT_EDITMSG` 文件内容):**
```
feat(auth): 实现用户注册接口

- 添加了用户注册的API端点 /users/register。
- 包括输入参数校验和密码哈希存储。
- 更新了相关的API文档。

Closes #42
Reviewed-by: reviewer_name
```

### 2. 使用 `gw save -m "提交信息"` 或 `gw commit -m "提交信息"`

这种方式适用于简单、只有一行的提交。

*   您需要在 `-m` 后的引号中提供**完全符合 `<type>(<scope>): <中文主题>` 格式**的提交信息。
*   **示例**：
    ```bash
    gw save -m "fix(ui): 修复登录按钮的CSS样式错位"
    ```
    ```bash
    gw commit -m "docs(readme): 更新项目简介和安装步骤"
    ```
*   **注意**：这种方式不方便添加多行的正文或页脚。如果需要，请使用编辑器模式。

### 3. 使用 `gw save -e` 或 `gw commit` (不带 `-m`，强制使用标准编辑器)

这种方式与第一种类似，会强制打开编辑器（通常是 Git 配置的默认编辑器，或者 `$VISUAL`/`$EDITOR` 环境变量指定的编辑器），让您编辑提交信息。操作步骤与第一种完全相同。

## 总结

遵循统一的 Git 提交信息规范对于团队协作和项目维护至关重要。通过合理使用 `gw save` 和 `gw commit` 命令，特别是其编辑器模式，您可以轻松地创建符合规范的、高质量的提交信息。
